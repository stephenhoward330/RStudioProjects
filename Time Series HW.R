
# Time Series HW

# NPS Stats https://irma.nps.gov/Stats/


# Washington Monument

# Washington Monument,Bookmark this report: https://irma.nps.gov/Stats/SSRSReports/Park%20Specific%20Reports/Annual%20Park%20Recreation%20Visitation%20(1904%20-%20Last%20Calendar%20Year)

washington<-read.csv(header=TRUE,stringsAsFactors=FALSE,text='
Year,RecreationVisitors,TotalRecreationVisitors
1936,"857,441","81,365,896"
1937,"998,686","81,365,896"
1938,"832,439","81,365,896"
1939,"927,543","81,365,896"
1940,"959,624","81,365,896"
1941,"965,689","81,365,896"
1942,"499,734","81,365,896"
1943,"472,004","81,365,896"
1944,"550,991","81,365,896"
1945,"608,667","81,365,896"
1946,"846,249","81,365,896"
1947,"794,813","81,365,896"
1948,"805,231","81,365,896"
1949,"867,327","81,365,896"
1950,"906,661","81,365,896"
1951,"962,000","81,365,896"
1952,"985,391","81,365,896"
1953,"1,022,269","81,365,896"
1954,"1,010,400","81,365,896"
1955,"1,039,900","81,365,896"
1956,"1,013,400","81,365,896"
1957,"1,143,100","81,365,896"
1958,"1,031,500","81,365,896"
1959,"1,186,000","81,365,896"
1960,"1,392,900","81,365,896"
1961,"1,592,300","81,365,896"
1962,"1,758,300","81,365,896"
1963,"1,750,200","81,365,896"
1964,"1,893,600","81,365,896"
1965,"1,986,100","81,365,896"
1966,"2,059,300","81,365,896"
1967,"1,905,200","81,365,896"
1968,"1,607,800","81,365,896"
1969,"1,658,500","81,365,896"
1970,"1,541,600","81,365,896"
1971,"1,518,500","81,365,896"
1972,"1,613,482","81,365,896"
1973,"1,446,500","81,365,896"
1974,"1,436,200","81,365,896"
1975,"1,064,500","81,365,896"
1976,"1,385,100","81,365,896"
1977,"1,230,900","81,365,896"
1978,"1,451,336","81,365,896"
1979,"1,304,790","81,365,896"
1980,"1,305,760","81,365,896"
1981,"1,359,061","81,365,896"
1982,"1,292,284","81,365,896"
1983,"1,212,736","81,365,896"
1984,"1,342,093","81,365,896"
1985,"1,229,062","81,365,896"
1986,"1,271,214","81,365,896"
1987,"1,300,983","81,365,896"
1988,"1,218,031","81,365,896"
1989,"1,136,662","81,365,896"
1990,"1,245,479","81,365,896"
1991,"1,168,736","81,365,896"
1992,"1,165,160","81,365,896"
1993,"1,080,030","81,365,896"
1994,"1,000,278","81,365,896"
1995,"943,098","81,365,896"
1996,"707,498","81,365,896"
1997,"841,218","81,365,896"
1998,"340,190","81,365,896"
1999,"553,420","81,365,896"
2000,"185,085","81,365,896"
2001,0,"81,365,896"
2002,"454,768","81,365,896"
2003,"529,985","81,365,896"
2004,"378,416","81,365,896"
2005,"467,550","81,365,896"
2006,"586,603","81,365,896"
2007,"591,081","81,365,896"
2008,"671,031","81,365,896"
2009,"676,002","81,365,896"
2010,"628,665","81,365,896"
2011,"430,153","81,365,896"
2012,0,"81,365,896"
2013,0,"81,365,896"
2014,"423,170","81,365,896"
2015,"493,550","81,365,896"
2016,"252,677","81,365,896"
2017,0,"81,365,896"
2018,0,"81,365,896"
')

# remove commas from within values
washington$RecreationVisitors<-as.numeric(gsub(',','',washington$RecreationVisitors))

# change to "Visitors (in millions)"
washington$RecreationVisitors<-washington$RecreationVisitors / 10^6

# plot it to see problems
plot(washington$Year,washington$RecreationVisitors,type="b",
     main="Washington Monument Annual Visitors (millions)",
     ylab="Visitors (millions)",xlab="Year")




# Jefferson Memorial

# Thomas Jefferson MEM,Bookmark this report: https://irma.nps.gov/Stats/SSRSReports/Park%20Specific%20Reports/Annual%20Park%20Recreation%20Visitation%20(1904%20-%20Last%20Calendar%20Year)

jefferson<-read.csv(header=TRUE,stringsAsFactors=FALSE,text='
Year,RecreationVisitors,TotalRecreationVisitors
1941,0,"114,225,543"
1942,"6,374","114,225,543"
1943,"528,527","114,225,543"
1944,"380,117","114,225,543"
1945,"443,595","114,225,543"
1946,"682,023","114,225,543"
1947,"639,200","114,225,543"
1948,"537,978","114,225,543"
1949,"554,435","114,225,543"
1950,"664,369","114,225,543"
1951,"911,120","114,225,543"
1952,"900,791","114,225,543"
1953,"812,070","114,225,543"
1954,"803,500","114,225,543"
1955,"754,500","114,225,543"
1956,"734,700","114,225,543"
1957,"834,800","114,225,543"
1958,"800,400","114,225,543"
1959,"782,000","114,225,543"
1960,"926,900","114,225,543"
1961,"811,500","114,225,543"
1962,"1,251,300","114,225,543"
1963,"1,423,200","114,225,543"
1964,"1,661,300","114,225,543"
1965,"1,699,400","114,225,543"
1966,"1,278,900","114,225,543"
1967,"1,375,000","114,225,543"
1968,"1,088,800","114,225,543"
1969,"1,261,100","114,225,543"
1970,"146,600","114,225,543"
1971,"1,279,800","114,225,543"
1972,"1,314,202","114,225,543"
1973,"1,319,400","114,225,543"
1974,"1,404,800","114,225,543"
1975,"1,632,700","114,225,543"
1976,"1,829,400","114,225,543"
1977,"1,696,200","114,225,543"
1978,"2,263,493","114,225,543"
1979,"2,328,095","114,225,543"
1980,"1,216,966","114,225,543"
1981,"1,788,267","114,225,543"
1982,"1,270,798","114,225,543"
1983,"1,485,531","114,225,543"
1984,"1,873,728","114,225,543"
1985,"2,261,477","114,225,543"
1986,"3,273,574","114,225,543"
1987,"1,818,622","114,225,543"
1988,"1,329,531","114,225,543"
1989,"923,811","114,225,543"
1990,"794,102","114,225,543"
1991,"655,444","114,225,543"
1992,"939,852","114,225,543"
1993,"714,095","114,225,543"
1994,"531,436","114,225,543"
1995,"588,051","114,225,543"
1996,"748,862","114,225,543"
1997,"953,408","114,225,543"
1998,"2,139,549","114,225,543"
1999,"2,218,837","114,225,543"
2000,"1,976,325","114,225,543"
2001,"2,225,756","114,225,543"
2002,"2,066,932","114,225,543"
2003,"1,642,293","114,225,543"
2004,"2,200,371","114,225,543"
2005,"2,312,726","114,225,543"
2006,"2,219,255","114,225,543"
2007,"2,327,254","114,225,543"
2008,"2,363,263","114,225,543"
2009,"2,337,868","114,225,543"
2010,"2,305,856","114,225,543"
2011,"1,945,696","114,225,543"
2012,"2,613,131","114,225,543"
2013,"2,609,463","114,225,543"
2014,"2,708,607","114,225,543"
2015,"3,102,442","114,225,543"
2016,"3,414,345","114,225,543"
2017,"3,366,571","114,225,543"
2018,"3,198,859","114,225,543"
')

# remove commas from within values
jefferson$RecreationVisitors<-as.numeric(gsub(',','',jefferson$RecreationVisitors))

# change to "Visitors (in millions)"
jefferson$RecreationVisitors<-jefferson$RecreationVisitors / 10^6

# plot it to see problems
plot(jefferson$Year,jefferson$RecreationVisitors,type="b",
     main="Jefferson Memorial Annual Visitors (millions)",
     ylab="Visitors (millions)",xlab="Year")




# Wright Bros Memorial

# Wright Brothers NMEM,Bookmark this report: https://irma.nps.gov/Stats/SSRSReports/Park%20Specific%20Reports/Annual%20Park%20Recreation%20Visitation%20(1904%20-%20Last%20Calendar%20Year)

wright<-read.csv(header=TRUE,stringsAsFactors=FALSE,text='
Year,RecreationVisitors,TotalRecreationVisitors
1934,"17,010","27,884,483"
1935,"28,472","27,884,483"
1936,"48,690","27,884,483"
1937,"82,188","27,884,483"
1938,"80,911","27,884,483"
1939,"70,071","27,884,483"
1940,"54,729","27,884,483"
1941,"86,025","27,884,483"
1942,"11,319","27,884,483"
1943,"11,054","27,884,483"
1944,"8,592","27,884,483"
1945,"15,439","27,884,483"
1946,"49,512","27,884,483"
1947,"77,739","27,884,483"
1948,"72,984","27,884,483"
1949,"86,327","27,884,483"
1950,"111,116","27,884,483"
1951,"113,324","27,884,483"
1952,"153,072","27,884,483"
1953,"184,328","27,884,483"
1954,"184,500","27,884,483"
1955,"184,600","27,884,483"
1956,"305,500","27,884,483"
1957,"327,900","27,884,483"
1958,"241,100","27,884,483"
1959,"197,900","27,884,483"
1960,"237,600","27,884,483"
1961,"257,100","27,884,483"
1962,"223,600","27,884,483"
1963,"249,700","27,884,483"
1964,"296,800","27,884,483"
1965,"302,700","27,884,483"
1966,"370,900","27,884,483"
1967,"340,000","27,884,483"
1968,"310,400","27,884,483"
1969,"324,900","27,884,483"
1970,"489,400","27,884,483"
1971,"392,300","27,884,483"
1972,"423,725","27,884,483"
1973,"413,600","27,884,483"
1974,"472,700","27,884,483"
1975,"485,200","27,884,483"
1976,"505,000","27,884,483"
1977,"535,000","27,884,483"
1978,"481,140","27,884,483"
1979,"396,322","27,884,483"
1980,"428,809","27,884,483"
1981,"429,618","27,884,483"
1982,"415,360","27,884,483"
1983,"484,289","27,884,483"
1984,"409,493","27,884,483"
1985,"448,677","27,884,483"
1986,"630,779","27,884,483"
1987,"315,957","27,884,483"
1988,"328,617","27,884,483"
1989,"472,894","27,884,483"
1990,"463,461","27,884,483"
1991,"461,494","27,884,483"
1992,"477,643","27,884,483"
1993,"477,362","27,884,483"
1994,"475,755","27,884,483"
1995,"434,671","27,884,483"
1996,"393,721","27,884,483"
1997,"425,132","27,884,483"
1998,"419,210","27,884,483"
1999,"375,681","27,884,483"
2000,"429,472","27,884,483"
2001,"438,548","27,884,483"
2002,"440,737","27,884,483"
2003,"712,181","27,884,483"
2004,"421,341","27,884,483"
2005,"458,948","27,884,483"
2006,"466,144","27,884,483"
2007,"494,331","27,884,483"
2008,"527,721","27,884,483"
2009,"476,291","27,884,483"
2010,"476,200","27,884,483"
2011,"445,455","27,884,483"
2012,"466,816","27,884,483"
2013,"447,796","27,884,483"
2014,"430,517","27,884,483"
2015,"437,184","27,884,483"
2016,"458,776","27,884,483"
2017,"414,244","27,884,483"
2018,"360,669","27,884,483"
')

# remove commas from within values
wright$RecreationVisitors<-as.numeric(gsub(',','',wright$RecreationVisitors))

# change to "Visitors (in millions)"
wright$RecreationVisitors<-wright$RecreationVisitors / 10^6

# plot it to see problems
plot(wright$Year,wright$RecreationVisitors,type="b",
     main="Wright Brothers Memorial Annual Visitors (millions)",
     ylab="Visitors (millions)",xlab="Year")




# Acadia

# Acadia NP,Bookmark this report: https://irma.nps.gov/Stats/SSRSReports/Park%20Specific%20Reports/Annual%20Park%20Recreation%20Visitation%20(1904%20-%20Last%20Calendar%20Year)

acadia<-read.csv(header=TRUE,stringsAsFactors=FALSE,text='
Year,RecreationVisitors,TotalRecreationVisitors
1919,"64,000","170,559,038"
1920,"66,500","170,559,038"
1921,"69,836","170,559,038"
1922,"73,779","170,559,038"
1923,"64,200","170,559,038"
1924,"71,758","170,559,038"
1925,"73,673","170,559,038"
1926,"101,256","170,559,038"
1927,"123,699","170,559,038"
1928,"134,897","170,559,038"
1929,"149,554","170,559,038"
1930,"154,734","170,559,038"
1931,"162,238","170,559,038"
1932,"237,596","170,559,038"
1933,"262,712","170,559,038"
1934,"275,956","170,559,038"
1935,"316,114","170,559,038"
1936,"340,393","170,559,038"
1937,"383,036","170,559,038"
1938,"394,319","170,559,038"
1939,"396,468","170,559,038"
1940,"382,084","170,559,038"
1941,"409,961","170,559,038"
1942,"36,544","170,559,038"
1943,"8,246","170,559,038"
1944,"12,916","170,559,038"
1945,"20,200","170,559,038"
1946,"382,390","170,559,038"
1947,"434,069","170,559,038"
1948,"420,846","170,559,038"
1949,"438,584","170,559,038"
1950,"485,220","170,559,038"
1951,"518,556","170,559,038"
1952,"549,075","170,559,038"
1953,"556,195","170,559,038"
1954,"553,800","170,559,038"
1955,"655,000","170,559,038"
1956,"735,500","170,559,038"
1957,"858,900","170,559,038"
1958,"816,500","170,559,038"
1959,"755,900","170,559,038"
1960,"1,638,200","170,559,038"
1961,"1,574,600","170,559,038"
1962,"1,601,500","170,559,038"
1963,"1,864,800","170,559,038"
1964,"2,011,600","170,559,038"
1965,"1,733,600","170,559,038"
1966,"2,158,400","170,559,038"
1967,"2,102,000","170,559,038"
1968,"2,303,300","170,559,038"
1969,"2,489,800","170,559,038"
1970,"2,776,300","170,559,038"
1971,"2,101,100","170,559,038"
1972,"2,285,881","170,559,038"
1973,"2,394,000","170,559,038"
1974,"2,335,800","170,559,038"
1975,"2,380,500","170,559,038"
1976,"2,353,300","170,559,038"
1977,"2,734,600","170,559,038"
1978,"2,684,933","170,559,038"
1979,"2,787,366","170,559,038"
1980,"2,779,666","170,559,038"
1981,"2,997,972","170,559,038"
1982,"3,572,114","170,559,038"
1983,"4,124,639","170,559,038"
1984,"3,734,763","170,559,038"
1985,"3,745,570","170,559,038"
1986,"3,929,054","170,559,038"
1987,"4,288,154","170,559,038"
1988,"4,502,283","170,559,038"
1989,"5,440,952","170,559,038"
1990,"2,339,591","170,559,038"
1991,"2,475,857","170,559,038"
1992,"2,382,113","170,559,038"
1993,"2,656,034","170,559,038"
1994,"2,710,749","170,559,038"
1995,"2,845,378","170,559,038"
1996,"2,704,831","170,559,038"
1997,"2,760,306","170,559,038"
1998,"2,594,497","170,559,038"
1999,"2,602,227","170,559,038"
2000,"2,469,238","170,559,038"
2001,"2,516,551","170,559,038"
2002,"2,558,572","170,559,038"
2003,"2,431,062","170,559,038"
2004,"2,207,847","170,559,038"
2005,"2,051,484","170,559,038"
2006,"2,083,588","170,559,038"
2007,"2,202,228","170,559,038"
2008,"2,075,857","170,559,038"
2009,"2,227,698","170,559,038"
2010,"2,504,208","170,559,038"
2011,"2,374,645","170,559,038"
2012,"2,431,052","170,559,038"
2013,"2,254,922","170,559,038"
2014,"2,563,129","170,559,038"
2015,"2,811,184","170,559,038"
2016,"3,303,393","170,559,038"
2017,"3,509,271","170,559,038"
2018,"3,537,575","170,559,038"
')

# remove commas from within values
acadia$RecreationVisitors<-as.numeric(gsub(',','',acadia$RecreationVisitors))

# change to "Visitors (in millions)"
acadia$RecreationVisitors<-acadia$RecreationVisitors / 10^6

# plot it to see problems
plot(acadia$Year,acadia$RecreationVisitors,type="b",
     main="Acadia NP Annual Visitors (millions)",
     ylab="Visitors (millions)",xlab="Year")




# Timpanogos Cave National Monument

# Timpanogos Cave NM,Bookmark this report: https://irma.nps.gov/Stats/SSRSReports/Park%20Specific%20Reports/Annual%20Park%20Recreation%20Visitation%20(1904%20-%20Last%20Calendar%20Year)

timp<-read.csv(header=TRUE,stringsAsFactors=FALSE,text='
Year,RecreationVisitors,TotalRecreationVisitors
1934,"5,074","8,508,736"
1935,"6,095","8,508,736"
1936,"9,766","8,508,736"
1937,"10,957","8,508,736"
1938,"12,808","8,508,736"
1939,"12,060","8,508,736"
1940,"12,021","8,508,736"
1941,"10,595","8,508,736"
1942,"7,967","8,508,736"
1943,"17,667","8,508,736"
1944,"19,565","8,508,736"
1945,"27,213","8,508,736"
1946,"56,919","8,508,736"
1947,"53,128","8,508,736"
1948,"60,575","8,508,736"
1949,"61,411","8,508,736"
1950,"65,355","8,508,736"
1951,"66,291","8,508,736"
1952,"68,532","8,508,736"
1953,"70,638","8,508,736"
1954,"72,000","8,508,736"
1955,"72,400","8,508,736"
1956,"76,700","8,508,736"
1957,"78,900","8,508,736"
1958,"89,400","8,508,736"
1959,"98,200","8,508,736"
1960,"110,100","8,508,736"
1961,"117,900","8,508,736"
1962,"133,500","8,508,736"
1963,"165,700","8,508,736"
1964,"165,200","8,508,736"
1965,"165,500","8,508,736"
1966,"193,600","8,508,736"
1967,"207,200","8,508,736"
1968,"221,400","8,508,736"
1969,"192,800","8,508,736"
1970,"166,500","8,508,736"
1971,"111,400","8,508,736"
1972,"194,525","8,508,736"
1973,"174,600","8,508,736"
1974,"226,600","8,508,736"
1975,"65,500","8,508,736"
1976,"76,500","8,508,736"
1977,"102,900","8,508,736"
1978,"118,644","8,508,736"
1979,"125,080","8,508,736"
1980,"107,041","8,508,736"
1981,"104,497","8,508,736"
1982,"104,630","8,508,736"
1983,"98,475","8,508,736"
1984,"119,688","8,508,736"
1985,"128,622","8,508,736"
1986,"124,410","8,508,736"
1987,"137,279","8,508,736"
1988,"138,694","8,508,736"
1989,"126,876","8,508,736"
1990,"114,247","8,508,736"
1991,"104,745","8,508,736"
1992,"120,374","8,508,736"
1993,"90,803","8,508,736"
1994,"77,528","8,508,736"
1995,"79,641","8,508,736"
1996,"97,250","8,508,736"
1997,"112,777","8,508,736"
1998,"119,074","8,508,736"
1999,"122,778","8,508,736"
2000,"115,115","8,508,736"
2001,"126,270","8,508,736"
2002,"114,736","8,508,736"
2003,"106,030","8,508,736"
2004,"107,170","8,508,736"
2005,"104,517","8,508,736"
2006,"110,840","8,508,736"
2007,"114,737","8,508,736"
2008,"123,682","8,508,736"
2009,"138,571","8,508,736"
2010,"120,241","8,508,736"
2011,"96,965","8,508,736"
2012,"118,764","8,508,736"
2013,"91,269","8,508,736"
2014,"95,679","8,508,736"
2015,"104,023","8,508,736"
2016,"91,261","8,508,736"
2017,"100,740","8,508,736"
2018,"121,311","8,508,736"
')

# remove commas from within values
timp$RecreationVisitors<-as.numeric(gsub(',','',timp$RecreationVisitors))

# change to "Visitors (in millions)"
timp$RecreationVisitors<-timp$RecreationVisitors / 10^6

# plot it to see problems
plot(timp$Year,timp$RecreationVisitors,type="b",
     main="Timpanogos Cave NM Annual Visitors (millions)",
     ylab="Visitors (millions)",xlab="Year")

# clear that the mean isn't constant over the full series
# consider filtering
timp1980<-subset(timp,Year>1980)
# confirm
plot(timp1980$Year,timp1980$RecreationVisitors,type="b",
     main="Timpanogos Cave NM Annual Visitors (millions)",
     ylab="Visitors (millions)",xlab="Year")

# fit ARIMA(1,1,1) model
library(astsa)
timp.out<-sarima(timp1980$RecreationVisitors, 1,1,1)

# report the parameter estimates and standard errors
timp.out$ttable

# predict next 5 years
timp.future<-sarima.for(timp1980$RecreationVisitors, 1,1,1, n.ahead=5)

# prediction interval for response variable
timp.future.L<-timp.future$pred - 2 * timp.future$se
timp.future.U<-timp.future$pred + 2 * timp.future$se

# table of predictions and 95% prediction intervals
cbind( timp.future$pred, timp.future.L, timp.future.U )

# create a publication quality graphic

plot(timp$Year,timp$RecreationVisitors,type="b",
     main="Timpanogos Cave NM Annual Visitors (millions)",
     ylab="Visitors (millions)",xlab="Year",
     xlim=c(1980,2024),ylim=c(.075,.145))
lines(2019:2023,timp.future$pred, type="b", pch=19, col="darkorange2")
lines(2019:2023,timp.future.L, lty=2, col="darkorange2")
lines(2019:2023,timp.future.U, lty=2, col="darkorange2")


